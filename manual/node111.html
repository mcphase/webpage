<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2025 (Released January 1, 2025) -->
<HTML lang="en">
<HEAD>
<TITLE>External module function dS1 - used by mcdisp</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2025">

<LINK REL="STYLESHEET" HREF="manual.css">

<LINK REL="next" HREF="node112.html">
<LINK REL="previous" HREF="node110.html">
<LINK REL="next" HREF="node112.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node112.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node102.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node110.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html982"
  HREF="node8.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html984"
  HREF="node180.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node112.html">External module function mqcalc</A>
<B> Up:</B> <A
 HREF="node102.html">Module Functions for Observables</A>
<B> Previous:</B> <A
 HREF="node110.html">External module function SMcalc</A>
 &nbsp; <B>  <A ID="tex2html983"
  HREF="node8.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html985"
  HREF="node180.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A ID="SECTION000162900000000000000"></A><A ID="4166"></A>
<BR>
External module function <I CLASS="slanted">dS1</I> - used by <I CLASS="slanted">mcdisp</I>
</H3><SPAN CLASS="SMALL">
</SPAN>
<P>
<SPAN CLASS="SMALL">In order to visualize spin fluctuations and to calculate neutron intensities
in dipole approximation the external single ion module has to provide the transition
matrix elements of the spin by the
vector <SPAN CLASS="MATH"><IMG
 STYLE="height: 1.81ex; vertical-align: -0.12ex; " SRC="img974.svg"
 ALT="$S1$"></SPAN>, which is given by:
 <!-- MATH
 ${\rm S1}^s_{\alpha}=\sqrt{(p_- -p_+)}\langle -|\hat S^s_{\alpha}-\langle \hat S^s_{\alpha}\rangle_{\mathbf H,T}|+\rangle$
 -->
<SPAN CLASS="MATH"><IMG
 STYLE="height: 3.13ex; vertical-align: -0.82ex; " SRC="img975.svg"
 ALT="${\rm S1}^s_{\alpha}=\sqrt{(p_--p_+)}\langle -\vert\hat S^s_{\alpha}-\langle \hat S^s_{\alpha}\rangle_{\mathbf H,T}\vert+\rangle$"></SPAN>. 
</SPAN>
<P>
<SPAN CLASS="SMALL">The format to be used is:
<SPAN CLASS="FOOTNOTESIZE">
</SPAN></SPAN><PRE>
extern "C" int dS1(int &amp; tn,double &amp; T,Vector &amp; Hxc,Vector &amp; Hext,double * g_J,Vector &amp; MODPAR,
char ** sipffilename,ComplexVector &amp; S1,float &amp; maxE, ComplexMatrix &amp; est)
</PRE><SPAN CLASS="SMALL"><SPAN CLASS="FOOTNOTESIZE"></SPAN>
The meaning of the symbols follows exactly that of function 
<I CLASS="slanted">dm1</I> and therefore not explained here.
</SPAN>
<P>
<SPAN CLASS="SMALL"></SPAN>
<BR><HR>

</BODY>
</HTML>
