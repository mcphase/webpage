<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2024.2 (Released October 21, 2024) -->
<HTML lang="en">
<HEAD>
<TITLE>External module function dchargedensity_coeff1 - used by mcdisp</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2024.2">

<LINK REL="STYLESHEET" HREF="manual.css">

<LINK REL="next" HREF="node105.html">
<LINK REL="previous" HREF="node103.html">
<LINK REL="next" HREF="node105.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node105.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node88.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node103.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html896"
  HREF="node7.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html898"
  HREF="node164.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node105.html">External module function spindensity_coeff</A>
<B> Up:</B> <A
 HREF="node88.html">Module Functions for Observables</A>
<B> Previous:</B> <A
 HREF="node103.html">External module function chargedensity_coeff</A>
 &nbsp; <B>  <A ID="tex2html897"
  HREF="node7.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html899"
  HREF="node164.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A ID="SECTION0001721600000000000000"></A><A ID="3674"></A>
<BR>
External module function <I CLASS="slanted">dchargedensity_coeff1</I> - used by <I CLASS="slanted">mcdisp</I>
</H3>

<P>
In order to visualize charge density  fluctuations 
 the external single ion module has to provide the transition
matrix elements of the chargedensity coefficient operator <!-- MATH
 $\sum_i \hat Z_{lm}(\Omega_i)$
 -->
<SPAN CLASS="MATH"><IMG
 STYLE="height: 3.12ex; vertical-align: -0.81ex; " SRC="img883.svg"
 ALT="$\sum_i \hat Z_{lm}(\Omega_i)$"></SPAN> by a
vector <SPAN CLASS="MATH"><IMG
 STYLE="height: 1.84ex; vertical-align: -0.12ex; " SRC="img884.svg"
 ALT="$cd1$"></SPAN>, which is given by:
 <!-- MATH
 ${\rm cd1}^s_{\alpha=lm}=\sqrt{(p_- -p_+)}\langle -|\sum_i \hat  Z^s_{lm}(\Omega_i)-\langle \sum_i\hat  Z^s_{lm}(\Omega_i)\rangle_{\mathbf H,T}|+\rangle$
 -->
<SPAN CLASS="MATH"><IMG
 STYLE="height: 3.13ex; vertical-align: -0.82ex; " SRC="img885.svg"
 ALT="${\rm cd1}^s_{\alpha=lm}=\sqrt{(p_--p_+)}\langle -\vert\sum_i \hat Z^s_{lm}(\Omega_i)-\langle \sum_i\hat Z^s_{lm}(\Omega_i)\rangle_{\mathbf H,T}\vert+\rangle$"></SPAN>. 

<P>
The format to be used is:
<SPAN CLASS="FOOTNOTESIZE">
</SPAN><PRE>
extern "C" int dchargedensity_ceoff1(int &amp; tn,double &amp; T,Vector &amp; Hxc,Vector &amp; Hext,double * g_J,Vector &amp; MODPAR,
char ** sipffilename,ComplexVector &amp; cd1,float &amp; maxE, ComplexMatrix &amp; est)
</PRE><SPAN CLASS="FOOTNOTESIZE"></SPAN>
The meaning of the symbols follows exactly that of function 
<I CLASS="slanted">dm1</I> and therefore not explained here.

<P>
<BR><HR>

</BODY>
</HTML>
