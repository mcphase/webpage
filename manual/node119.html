<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2025 (Released January 1, 2025) -->
<HTML lang="en">
<HEAD>
<TITLE>External module function chargedensity_coeff - used by densplt, spins, display_density,display_densities</TITLE>

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2025">

<LINK REL="STYLESHEET" HREF="manual.css">

<LINK REL="next" HREF="node120.html">
<LINK REL="previous" HREF="node118.html">
<LINK REL="next" HREF="node120.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node120.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node102.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node118.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html1014"
  HREF="node8.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html1016"
  HREF="node180.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node120.html">External module function dchargedensity_coeff1</A>
<B> Up:</B> <A
 HREF="node102.html">Module Functions for Observables</A>
<B> Previous:</B> <A
 HREF="node118.html">External module function dpel1</A>
 &nbsp; <B>  <A ID="tex2html1015"
  HREF="node8.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html1017"
  HREF="node180.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H3><A ID="SECTION0001621700000000000000"></A><A ID="4335"></A><A ID="4336"></A><A ID="4337"></A><A ID="4338"></A>
<BR>
External module function <I CLASS="slanted">chargedensity_coeff</I> -
used by <I CLASS="slanted">densplt</I>,
<I CLASS="slanted">spins</I>,
<I CLASS="slanted">display_density</I>,<I CLASS="slanted">display_densities</I>
</H3><SPAN CLASS="SMALL">
</SPAN>
<P>
<SPAN CLASS="SMALL">In order to calculate the chargedensity, the expansion coefficients
have to be evaluated and
 the following function has to be present in the module file <I CLASS="slanted">*.so</I>:
</SPAN>
<P>
<SPAN CLASS="SMALL"></SPAN><PRE>
extern "C" void chargedensity_coeff(Vector &amp; cd,double * T, Vector &amp; Hxc, Vector &amp; Hext,
                      double * gJ, Vector &amp; MODPAR,
                      char ** sipffilename, ComplexMatrix &amp; Icalc_parstorage);
</PRE><SPAN CLASS="SMALL">
</SPAN>
<P>
<SPAN CLASS="SMALL">it works exactly as <I CLASS="slanted">mcalc</I> with the only modification
that the vector cd has 28 components, therefore we do not give more details here.
</SPAN>
<P>
<SPAN CLASS="SMALL">The module function must perform the following task:
</SPAN>
<OL>
<LI>calculate the coefficients of <!-- MATH
 $-|e|Z_l^m R^2(r)$
 -->
<SPAN CLASS="MATH"><IMG
 STYLE="height: 2.77ex; vertical-align: -0.77ex; " SRC="img1002.svg"
 ALT="$-\vert e\vert Z_l^m R^2(r)$"></SPAN> in the expansion of
      the charge density in equation (<A HREF="node166.html#chargedensity2">250</A>).
      The output Vector cd(1,...,28) should contain  coefficients 
     (i.e. <!-- MATH
 $\langle\sum_i Z_l^m (\Omega_i)\rangle$
 -->
<SPAN CLASS="MATH"><IMG
 STYLE="height: 2.66ex; vertical-align: -0.81ex; " SRC="img932.svg"
 ALT="$\langle\sum_i Z_l^m(\Omega_i)\rangle$"></SPAN>)
      in the following order (lm):  00, 2-2, 2-1,20,21,22, 4-4, 4-3,..,44,6-6,6-5 ...,65,66
</LI>
<LI>if <SPAN CLASS="MATH"><IMG
 STYLE="height: 1.90ex; vertical-align: -0.21ex; " SRC="img949.svg"
 ALT="$T&lt;0$"></SPAN> all quantities should be evaluated assuming that all Boltzmann probabilities <SPAN CLASS="MATH"><IMG
 STYLE="height: 1.68ex; vertical-align: -0.57ex; " SRC="img219.svg"
 ALT="$p_i$"></SPAN>
 are zero except for the state number <SPAN CLASS="MATH"><IMG
 STYLE="height: 2.55ex; vertical-align: -0.70ex; " SRC="img950.svg"
 ALT="$n=(-T)$"></SPAN>, for which the probability <SPAN CLASS="MATH"><IMG
 STYLE="height: 2.17ex; vertical-align: -0.57ex; " SRC="img951.svg"
 ALT="$p_n=1$"></SPAN>.
</LI>
</OL><SPAN CLASS="SMALL">
</SPAN>
<P>
<SPAN CLASS="SMALL"></SPAN>
<BR><HR>

</BODY>
</HTML>
